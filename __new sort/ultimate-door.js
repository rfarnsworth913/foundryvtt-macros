// https://cdn.discordapp.com/attachments/1001709111651618816/1001709116504408124/unknown.png
{
  "name": "Ultimate Door (Setup)",
  "type": "script",
  "author": "7SioMgBTZLyfZCY8",
  "img": "icons/svg/dice-target.svg",
  "scope": "global",
  "command": "if(!canvas.background.controlled.length) ui.notifications.error('No currently selected Tile');\n\nfor(let tile of canvas.background.controlled){\n    tile.document.update({'flags.monks-active-tiles': {\"active\":true,\"restriction\":\"all\",\"controlled\":\"all\",\"trigger\":\"manual\",\"pertoken\":false,\"minrequired\":0,\"chance\":100,\"actions\":[{\"action\":\"anchor\",\"data\":{\"tag\":\"_doorchecklock\",\"stop\":true},\"id\":\"vUXOmdFFu4aMfjU5\"},{\"action\":\"dialog\",\"data\":{\"dialogtype\":\"confirm\",\"title\":\"Locked Door\",\"content\":\"<form>\\n  The door is locked; what do you wish to do?\\n<input type=\\\"hidden\\\" id=\\\"dialog-redirect\\\" name=\\\"goto\\\" />\\n  <button type=\\\"button\\\" onclick=\\\"$('#dialog-redirect').val('Key');\\\">Try a key.</button>\\n  <button type=\\\"button\\\" onclick=\\\"$('#dialog-redirect').val('Lockpick');\\\">Try to lockpick it.</button>\\n  <button type=\\\"button\\\" onclick=\\\"$('#dialog-redirect').val('Break & Enter');\\\">Try to break it.</button>\\n  <button type=\\\"button\\\" onclick=\\\"$('#dialog-redirect').val('Mimic');\\\">Try to seduce it.</button>\\n</form>\",\"yes\":\"null\",\"no\":\"\"},\"id\":\"1lNo8DHbn9shXlUa\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Key\",\"stop\":true},\"id\":\"b7gxGbZhQvGglZmH\"},{\"action\":\"inventory\",\"data\":{\"entity\":\"\",\"item\":\"Key\",\"count\":\"> 0\"},\"id\":\"VYxhx8C2MSMKatob\"},{\"action\":\"exists\",\"data\":{\"entity\":\"\",\"collection\":\"tokens\",\"count\":\"> 0\",\"none\":\"No Key\"},\"id\":\"uTcSxCvicGi5UusG\"},{\"action\":\"chatmessage\",\"data\":{\"text\":\"You use the key to unlock the door.\",\"flavor\":\"\",\"entity\":{\"id\":\"Scene.JpnHkjeyYLpvD49L.Token.pH352CqF2MF7pNwH\",\"name\":\"Gamemaster\"},\"incharacter\":true,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"k8K0qGO2ldxnPnrp\"},{\"action\":\"goto\",\"data\":{\"entity\":{},\"state\":\"close\",\"type\":\"door\",\"location\":{},\"item\":{},\"actor\":{},\"tag\":\"SUCCESS\",\"limit\":null,\"resume\":false},\"id\":\"0NUMGe7bPnj7HN4r\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Lockpick\",\"stop\":true},\"id\":\"S6BkQ4Olh1JQ6AWb\"},{\"action\":\"inventory\",\"data\":{\"entity\":{\"id\":\"token\",\"name\":\"Triggering Token\"},\"item\":\"Thieves' Tools\"},\"id\":\"M3036k1gLtVl5Zxf\"},{\"action\":\"exists\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"MonksActiveTiles.PreviousData\"},\"collection\":\"tokens\",\"count\":\"> 0\",\"none\":\"No Lockpicks\"},\"id\":\"dj4SP2TD6JQa9IPd\"},{\"action\":\"monks-tokenbar.requestroll\",\"data\":{\"entity\":\"\",\"request\":\"ability:dex\",\"dc\":14,\"flavor\":\"\",\"rollmode\":\"roll\",\"silent\":true,\"fastforward\":false,\"usetokens\":\"all\",\"continue\":\"always\"},\"id\":\"WWHzXWUcIosqHgJP\"},{\"action\":\"monks-tokenbar.filterrequest\",\"data\":{\"passed\":\"Lockpick Success\",\"failed\":\"Lockpick Failure\",\"resume\":\"\"},\"id\":\"38VgyXnbTr0JJwWz\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"No Key\",\"stop\":true},\"id\":\"gDkZac90Wlw6nEFD\"},{\"action\":\"chatmessage\",\"data\":{\"flavor\":\"\",\"text\":\"None of your keys work on this lock.\",\"entity\":\"\",\"incharacter\":false,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"TrditTpcWBIv3VWa\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Break & Enter\",\"stop\":true},\"id\":\"cB3Pz7mP8QPvhv5k\"},{\"action\":\"monks-tokenbar.requestroll\",\"data\":{\"entity\":\"\",\"request\":\"ability:str\",\"dc\":17,\"flavor\":\"You attempt to break the door down...\",\"rollmode\":\"roll\",\"silent\":true,\"fastforward\":false,\"usetokens\":\"all\",\"continue\":\"always\"},\"id\":\"XnxhsbyMoPvDSTS8\"},{\"action\":\"monks-tokenbar.filterrequest\",\"data\":{\"passed\":\"Strength Success\",\"failed\":\"Strength Failure\",\"resume\":\"\"},\"id\":\"Wb1XitD540yGP0mQ\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Lockpick Success\",\"stop\":true},\"id\":\"rGS6GXKZqhL3gUhl\"},{\"action\":\"chatmessage\",\"data\":{\"text\":\"You successfully pick the lock.\",\"flavor\":\"\",\"entity\":{\"id\":\"previous\",\"name\":\"Current tokens\"},\"incharacter\":true,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"7wxBodBIzXIWJSSk\"},{\"action\":\"goto\",\"data\":{\"entity\":{},\"state\":\"close\",\"type\":\"door\",\"location\":{},\"item\":{},\"actor\":{},\"tag\":\"SUCCESS\",\"limit\":null,\"resume\":false},\"id\":\"LU0dpEHUhD4bp0R0\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Lockpick Failure\",\"stop\":true},\"id\":\"Ea82kcc1WrpBHNby\"},{\"action\":\"chatmessage\",\"data\":{\"text\":\"You fail to pick the lock.\",\"flavor\":\"\",\"entity\":{\"id\":\"previous\",\"name\":\"Current tokens\"},\"incharacter\":true,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"6i43kO5d2tio4k0V\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Strength Success\",\"stop\":true},\"id\":\"hOzoTDZz2uwNoYJy\"},{\"action\":\"chatmessage\",\"data\":{\"flavor\":\"\",\"text\":\"You successfully break down the door.\",\"entity\":\"\",\"incharacter\":false,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"JURL76WUkOCpzDv0\"},{\"action\":\"changedoor\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"Current walls\"},\"state\":\"open\",\"type\":\"secret\"},\"id\":\"5FVNvPZrcp8EuaTL\"},{\"action\":\"tileimage\",\"data\":{\"entity\":\"\",\"select\":\"3\",\"transition\":\"none\",\"speed\":1,\"loop\":1},\"id\":\"0o0hrVscLiOKWC6y\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Strength Failure\",\"stop\":true},\"id\":\"hBkOEww2CQRs44PQ\"},{\"action\":\"chatmessage\",\"data\":{\"flavor\":\"\",\"text\":\"You fail to break down the door.\",\"entity\":\"\",\"incharacter\":false,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"eD8gCnGzFiLePqUE\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"SUCCESS\",\"stop\":true},\"id\":\"gNmJI58RUPXqcZKJ\"},{\"action\":\"changedoor\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"Current walls\"},\"state\":\"close\",\"type\":\"door\"},\"id\":\"TGEmMXnOD9RQdFg8\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"No Lockpicks\",\"stop\":true},\"id\":\"kXKbwHAhziwD07K3\"},{\"action\":\"chatmessage\",\"data\":{\"flavor\":\"\",\"text\":\"You have no tools to try to pick the lock with.\",\"entity\":\"\",\"incharacter\":false,\"chatbubble\":false,\"for\":\"token\",\"language\":\"\"},\"id\":\"jrTCtL7cGu9qBCqV\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"_dooropen\",\"stop\":true},\"id\":\"LVrlShHQpLEIPwiA\"},{\"action\":\"attribute\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"Current tokens\"},\"collection\":\"walls\",\"attribute\":\"door\",\"value\":\"= 1\"},\"id\":\"EwdaPU5LUzUYU4Hl\"},{\"action\":\"exists\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"Current tokens\"},\"collection\":\"walls\",\"count\":\"> 0\",\"none\":\"\"},\"id\":\"BNYIx6MD5XKNR1dr\"},{\"action\":\"tileimage\",\"data\":{\"entity\":\"\",\"select\":\"2\",\"transition\":\"none\",\"speed\":1,\"loop\":1},\"id\":\"TFNUYYSmnN1XYO1L\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"_doorclose\",\"stop\":true},\"id\":\"c87fdQY9zxi0fwBS\"},{\"action\":\"tileimage\",\"data\":{\"entity\":\"\",\"select\":\"1\",\"transition\":\"none\",\"speed\":1,\"loop\":1},\"id\":\"gKDgyu5yqSYzOTb7\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"Mimic\",\"stop\":true},\"id\":\"ugODPAwFTKT91cXc\"},{\"action\":\"showhide\",\"data\":{\"entity\":{\"id\":\"tile\",\"name\":\"This Tile\"},\"collection\":\"tokens\",\"hidden\":\"hide\",\"fade\":0},\"id\":\"Yhuv7upVuOJb4WQJ\"},{\"action\":\"create\",\"data\":{\"entity\":{\"id\":\"Actor.n0cQ2YyB4Dvl4F8p\",\"name\":\"Mimic\"},\"collection\":\"actors\",\"location\":{\"id\":\"tagger:Door Tile {#}\",\"match\":\"all\",\"scene\":\"_active\",\"name\":\"<i class=\\\"fas fa-tag fa-sm\\\"></i> Door Tile {#}\"},\"snap\":true,\"invisible\":false,\"avoidtokens\":false},\"id\":\"e2fKIuqqnsrKIPeM\"},{\"action\":\"changedoor\",\"data\":{\"entity\":{\"id\":\"previous\",\"name\":\"Current walls\"},\"state\":\"open\",\"type\":\"secret\"},\"id\":\"7YqnK0ekozZzWhbW\"},{\"action\":\"anchor\",\"data\":{\"tag\":\"_doorsecret\",\"stop\":true},\"id\":\"S46mkYGrlfnor1NW\"},{\"action\":\"tileimage\",\"data\":{\"entity\":\"\",\"select\":\"3\",\"transition\":\"none\",\"speed\":1,\"loop\":1},\"id\":\"ikDjYaOrFIWqiybS\"}],\"record\":false,\"usealpha\":false,\"pointer\":false,\"allowpaused\":false,\"fileindex\":0,\"files\":[{\"id\":\"gZMLyJIsMDElQKXV\",\"name\":\"https://assets.forge-vtt.com/61ddcf9211447625807f3383/Tiles/Buildings/Doors/Wooden/Door%20Dark%2001%20Closed%20%5B1x2%5D%20300%20dpi%2075%25.webp\",\"selected\":true},{\"id\":\"6Ktc2khuhengr29G\",\"name\":\"https://assets.forge-vtt.com/61ddcf9211447625807f3383/Tiles/Buildings/Doors/Wooden/Door%20Dark%2001%20Open%20%5B1x2%5D%20300%20dpi%2075%25.webp\",\"selected\":false},{\"id\":\"gwoGjvDSwUBvVIg9\",\"name\":\"https://assets.forge-vtt.com/61ddcf9211447625807f3383/Tiles/Buildings/Doors/Wooden/Door%20Dark%20Broken%2001%20%5B1x2%5D%20300%20dpi%2075%25.webp\",\"selected\":false}]}});\n}\n\nui.notifications.info('Tiles have been setup');",
  "flags": {
    "scene-packer": {
      "hash": "dd1564080c73c4b452374670022b089143f739c6",
      "sourceId": "Macro.RbBgaY4DIeWXoAT2"
    },
    "combat-utility-belt": {
      "macroTrigger": ""
    },
    "advanced-macros": {
      "runAsGM": false
    },
    "exportSource": {
      "world": "crow's-world",
      "system": "dnd5e",
      "coreVersion": "9.269",
      "systemVersion": "1.6.3"
    }
  }
}
